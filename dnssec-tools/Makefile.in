PERLDIRS=tools/modules tools/donuts tools/mapper tools/scripts tools/dnspktflow

SUBDIRS=lib/libsres lib/libval

all: makeit

makeit: perlmakefiles perlmake subdirmake

install: perlinstall subdirinstall

clean: perlclean subdirclean

distclean: clean configclean

#
# Subdir build rules
#

subdirmake:
	@for i in $(SUBDIRS) ; do \
	  (cd $$i ; make ) ; \
         done

subdirinstall:
	@for i in $(SUBDIRS) ; do \
	  (cd $$i ; make install ) ; \
         done

subdirclean:
	@for i in $(SUBDIRS) ; do \
	  (cd $$i ; make clean ) ; \
         done

#
# Perl system build rules
#

perlmake:
	@for i in $(PERLDIRS) ; do \
	  (cd $$i ; make ) ; \
         done

perlmakefiles:
	@for i in $(PERLDIRS) ; do \
	  if test ! -f $$i/Makefile ; then \
	    (cd $$i ; perl Makefile.PL ) ; \
          fi ; \
         done

perlinstall:
	@for i in $(PERLDIRS) ; do \
	  (cd $$i ; make install ) ; \
         done

perlclean:
	@for i in $(PERLDIRS) ; do \
	  (cd $$i ; make clean ) ; \
         done

#
# Config system rules
#

configclean:
	rm -f config.cache config.status config.log \
		Makefile stamp-h *.core
