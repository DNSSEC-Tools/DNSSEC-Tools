
INCL= ../libsres
LIB= ../libsres
CFLAGS_EX=-I$(INCL) -I.
EXTRALIBS=-lval -lsres -lcrypto
LDFLAGS_EX=-L. -L$(LIB) $(EXTRALIBS)

SRC=  	res_squery.c \
	val_support.c \
	val_zone.c \
	val_cache.c \
	val_context.c \
	val_verify.c \
	val_parse.c \
	val_print.c \
	val_query.c \
	val_log.c \
	val_x_query.c \
	val_gethostbyname.c \
	crypto/val_rsamd5.c \
	crypto/val_rsasha1.c \
	crypto/val_dsasha1.c

# can't use gmake conventions to translate SRC -> OBJ for portability
OBJ=  	res_squery.o \
	val_support.o \
	val_zone.o \
	val_cache.o \
	val_context.o \
	val_verify.o \
	val_parse.o \
	val_print.o \
	val_log.o \
	val_query.o \
	val_x_query.o \
	val_gethostbyname.o \
	crypto/val_rsamd5.o \
	crypto/val_rsasha1.o \
	crypto/val_dsasha1.o

LOBJ=  	res_squery.lo \
	val_support.lo \
	val_zone.lo \
	val_cache.lo \
	val_context.lo \
	val_verify.lo \
	val_parse.lo \
	val_print.lo \
	val_log.lo \
	val_query.lo \
	val_x_query.lo \
	val_gethostbyname.lo \
	crypto/val_rsamd5.lo \
	crypto/val_rsasha1.lo \
	crypto/val_dsasha1.lo


LIBVAL=libval.la

DRIVER= driver 
#VALIDATOR=validate (for future)
VALIDATOR= verify
GETHOST= gethost

all: $(LIBVAL) $(DRIVER) $(VALIDATOR) $(GETHOST)

clean:
	$(RM) -f $(LOBJ) $(OBJ) $(LIBVAL) $(DRIVER) $(VALIDATOR) $(GETHOST) resolver_driver.lo main.lo gethost.lo

$(LIBVAL): $(LOBJ)
	$(LIBTOOLLD) -o $@ $(LOBJ)

$(DRIVER): $(LIBVAL) resolver_driver.lo
	$(LIBTOOLLD) -o $@ resolver_driver.lo $(LDFLAGS)

$(VALIDATOR): $(LIBVAL) main.lo
	$(LIBTOOLLD) -o $@ main.lo $(LDFLAGS)

$(GETHOST): $(LIBVAL) gethost.lo
	$(LIBTOOLLD) -o $@ gethost.lo $(LDFLAGS)

install:
	$(LIBTOOLIN) $(LIBVAL) $(libdir)
	$(LIBTOOLFN)
	$(INSTALL) val_api.h    $(includedir)
	$(INSTALL) val_errors.h $(includedir)
