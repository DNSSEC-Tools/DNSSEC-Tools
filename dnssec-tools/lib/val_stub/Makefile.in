
INCL= ../libsres
LIB= ../libsres
CFLAGS_EX=-I$(INCL) -I.
EXTRALIBS=-lval -lsres -lcrypto
LDFLAGS_EX=-L. -L$(LIB) $(EXTRALIBS)

SRC=  	val_resquery.c \
	val_support.c \
	val_zone.c \
	val_cache.c \
	val_context.c \
	val_verify.c \
	val_parse.c \
	val_policy.c \
	val_print.c \
	val_query.c \
	val_log.c \
	val_x_query.c \
	val_assertion.c\
	val_getaddrinfo.c \
	val_gethostbyname.c \
	crypto/val_rsamd5.c \
	crypto/val_rsasha1.c \
	crypto/val_dsasha1.c

# can't use gmake conventions to translate SRC -> OBJ for portability
OBJ=  	val_resquery.o \
	val_support.o \
	val_zone.o \
	val_cache.o \
	val_context.o \
	val_verify.o \
	val_parse.o \
	val_policy.o \
	val_print.o \
	val_log.o \
	val_query.o \
	val_x_query.o \
	val_assertion.o\
	val_getaddrinfo.o \
	val_gethostbyname.o \
	crypto/val_rsamd5.o \
	crypto/val_rsasha1.o \
	crypto/val_dsasha1.o

LOBJ=  	val_resquery.lo \
	val_support.lo \
	val_zone.lo \
	val_cache.lo \
	val_context.lo \
	val_verify.lo \
	val_parse.lo \
	val_policy.lo \
	val_print.lo \
	val_log.lo \
	val_query.lo \
	val_x_query.lo \
	val_assertion.lo\
	val_getaddrinfo.lo \
	val_gethostbyname.lo \
	crypto/val_rsamd5.lo \
	crypto/val_rsasha1.lo \
	crypto/val_dsasha1.lo


LIBVAL=libval.la

DRIVER= driver 
#VALIDATOR=validate (for future)
VALIDATOR= validate
GETHOST= gethost
GETADDR= getaddr

all: $(LIBVAL) $(DRIVER) $(VALIDATOR) $(GETHOST) $(GETADDR)

clean:
	$(RM) -f $(LOBJ) $(OBJ) $(LIBVAL) $(DRIVER) $(VALIDATOR) $(GETHOST) $(GETADDR) validator_driver.lo validator_driver.o main.lo main.o gethost.lo gethost.o getaddr.lo getaddr.o

$(LIBVAL): $(LOBJ)
	$(LIBTOOLLD) -o $@ $(LOBJ)

$(DRIVER): $(LIBVAL) validator_driver.lo
	$(LIBTOOLLD) -o $@ validator_driver.lo $(LDFLAGS)

$(VALIDATOR): $(LIBVAL) main.lo
	$(LIBTOOLLD) -o $@ main.lo $(LDFLAGS)

$(GETHOST): $(LIBVAL) gethost.lo
	$(LIBTOOLLD) -o $@ gethost.lo $(LDFLAGS)

$(GETADDR): $(LIBVAL) getaddr.lo
	$(LIBTOOLLD) -o $@ getaddr.lo $(LDFLAGS)

install:
	$(LIBTOOLIN) $(LIBVAL) $(libdir)
	$(LIBTOOLFN)
	$(INSTALL) val_api.h $(includedir)
	$(INSTALL) val_query.h $(includedir)
	$(INSTALL) val_x_query.h $(includedir)
	$(INSTALL) validator.h $(includedir)
	$(INSTALL) val_errors.h $(includedir)
	$(INSTALL) val_gethostbyname.h $(includedir)
	$(INSTALL) val_getaddrinfo.h $(includedir)
