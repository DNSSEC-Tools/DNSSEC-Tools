<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Emergency ZSK Rollover (Published ZSK Compromise)</title><meta name="generator" content="DocBook XSL Stylesheets V1.70.1"><link rel="start" href="index.html" title="Step-by-Step DNSSEC-Tools Operator Guidance Document"><link rel="up" href="index.html" title="Step-by-Step DNSSEC-Tools Operator Guidance Document"><link rel="prev" href="step-emergency-current-zsk.html" title="Emergency ZSK Rollover (Current ZSK Compromise)"><link rel="next" href="step-emergency-zsk.html" title="Emergency ZSK Rollover (Published and Current ZSK
    Compromise)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Emergency ZSK Rollover (Published ZSK Compromise)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="step-emergency-current-zsk.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="step-emergency-zsk.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="step-emergency-zsk-published"></a>Emergency ZSK Rollover (Published ZSK Compromise)</h2></div></div></div><p><span class="bold"><strong>If the KSK is also compromised, perform the
    emergency KSK rollover first.</strong></span></p><p>As long as there is a valid KSK signature over the ZSK, the KSK can
    continue to be used to inject false zone data. If both keys are
    compromised, clients are exposed to attacks on that data until the maximum
    of the expiration of the KSK's RRSIG (created by the ZSK) and the parent's
    signature over the DS of that KSK. (These attacks include signatures over
    false data, replay attacks of the old KSK, and replay attacks of the old
    DS.) Short TTLs allow recursive servers to more quickly recover from
    key-compromise situations, allowing them to get new keys more quickly. Key
    compromise exposes the secure recursive server to replays of the old key
    until the signature expires.</p><p>The emergency procedures described for key rollover uses that
    rationale that injection of valid but false data (which can be generated
    using the compromised key) is more serious than discontinuity in the
    ability to validate true data. Thus, during emergency ZSK rollover, there
    will be a period (up to twice the maximum zone TTL) where the cached zone
    data may not validate against the new ZSK.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="step-rollover-zsk-emergency-published"></a>Manual Emergency Published ZSK Rollover</h3></div></div></div><p>The DNSSEC-Tools utilities do not currently handle emergency ZSK
        rollover. The steps given below detail the double-signature scheme
        used for KSK rollover.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-1"></a>Generate a New ZSK</h4></div></div></div><p>Generate a new ZSK as described in Section ???. Update the
            Key-Tag Table with the new ZSK and set its status to New
            (N).</p><div class="table"><a name="id932461"></a><p class="title"><b>Table 15. </b></p><div class="table-contents"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col></colgroup><tbody><tr><td rowspan="2" align="center">
                                <span class="bold"><strong>Zone</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>ZSKs</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>KSKs</strong></span>
                            </td><td rowspan="2" align="center">
                                <span class="bold"><strong>Exp</strong></span>
                            </td></tr><tr><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td></tr><tr><td rowspan="3" align="center">
                                <span class="emphasis"><em>zone-name</em></span>

                                <span class="emphasis"><em></em></span>

                                <span class="emphasis"><em></em></span>
                            </td><td align="center">
                                <span class="underline">zsktag-cur</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">C</td><td rowspan="3" align="center">
                                <span class="underline">ksktag</span>

                                <span class="underline"></span>

                                <span class="underline"></span>
                            </td><td rowspan="3" align="center">2048</td><td rowspan="3" align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>

                                <span class="underline"></span>
                            </td><td rowspan="3" align="center">C</td><td rowspan="3" align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>

                                <span class="underline"></span>
                            </td></tr><tr><td align="center">
                                <span class="underline">zsktag-pub</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">P</td></tr><tr><td align="center">
                                <span class="underline">sktag-new</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">N</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-2"></a>Modify the Zone File</h4></div></div></div><p>The zone file must be modified to account for the key
            changes. The Published ZSK must be deleted and the New ZSK must be
            added. Also, the SOA serial number must be incremented so that the
            zone file's new contents will be recognized.</p><p>The required key changes are made by modifying the <span class="bold"><strong>$INCLUDE</strong></span> lines at the end of the file. The
            <span class="bold"><strong>$INCLUDE</strong></span> line for the Published
            ZSK must be deleted. An <span class="bold"><strong>$INCLUDE</strong></span>
            line for the New ZSK must be added.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-3"></a>Sign the Zone with the KSK and Current ZSK Only</h4></div></div></div><p>Follow the steps in sections ??? - ??? if the zone does no
            delegation. Follow the steps in sections ??? - ??? if the zone
            does delegation. The ZSK used in the signing process in ??? or ???
            must be the key that is marked as the Current key (C) in the
            Key-Tag table. The KSK used as input to <span class="bold"><strong>dnssec-signzone</strong></span> does not change, so the
            keyset does not change and does not have to be re-sent to the
            parent.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-4"></a>Reload the Zone</h4></div></div></div><p>The <span><strong class="command">rndc</strong></span> will reload the name server
            configuration files and the zone contents. The name server process
            is assumed to be already running.</p><table class="simplelist" border="0" summary="Simple list"><tr><td><span><strong class="command"># rndc reload zone-name</strong></span>
	            <strong class="userinput"><code>[ENTER]</code></strong>
		</td></tr><tr><td><span><strong class="command">#</strong></span></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-5"></a>Update the Key-Tags Table</h4></div></div></div><p>Update the Key-Tags table to reflect the changed key status.
            Delete the old Published ZSK. Change the status of the New ZSK to
            Published.</p><div class="table"><a name="id932896"></a><p class="title"><b>Table 16. </b></p><div class="table-contents"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col></colgroup><tbody><tr><td rowspan="2" align="center">
                                <span class="bold"><strong>Zone</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>ZSKs</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>KSKs</strong></span>
                            </td><td rowspan="2" align="center">
                                <span class="bold"><strong>Exp</strong></span>
                            </td></tr><tr><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td></tr><tr><td rowspan="5" align="center">
                                <span class="emphasis"><em>zone-name</em></span>

                                <span class="emphasis"><em></em></span>

                                <span class="emphasis"><em></em></span>
                            </td><td align="center">
                                <span class="underline">zsktag-cur</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">C</td><td rowspan="5" align="center">
                                <span class="underline">ksktag</span>

                                <span class="underline"></span>

                                <span class="underline"></span>
                            </td><td rowspan="5" align="center">2048</td><td rowspan="5" align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>

                                <span class="underline"></span>
                            </td><td rowspan="5" align="center">C</td><td rowspan="2" align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>
                            </td></tr><tr><td rowspan="2" align="center">
                                <span class="underline">zsktag-pub</span>
                            </td><td rowspan="2" align="center">1024</td><td rowspan="2" align="center">
                                <span class="underline">date</span>
                            </td><td rowspan="2" align="center">P</td></tr><tr><td align="center"> </td></tr><tr><td rowspan="2" align="center">
                                <span class="underline">zsktag-new</span>
                            </td><td rowspan="2" align="center">1024</td><td rowspan="2" align="center">
                                <span class="underline">date</span>
                            </td><td rowspan="2" align="center"><p>N</p><p>P</p></td><td align="center">
                                <span class="underline"></span>
                            </td></tr><tr><td align="center"> </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-zsk-emergency-published-6"></a>Dispose of the Old Zone Key</h4></div></div></div><p>Delete the old ZSK's <span class="emphasis"><em>.private</em></span> and
            <span class="emphasis"><em>.key</em></span> files.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="step-emergency-current-zsk.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="step-emergency-zsk.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Emergency ZSK Rollover (Current ZSK Compromise) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Emergency ZSK Rollover (Published and Current ZSK
    Compromise)</td></tr></table></div></body></html>
