<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>KSK Rollover (Double-Signature Scheme)</title><meta name="generator" content="DocBook XSL Stylesheets V1.70.1"><link rel="start" href="index.html" title="Step-by-Step DNSSEC-Tools Operator Guidance Document"><link rel="up" href="index.html" title="Step-by-Step DNSSEC-Tools Operator Guidance Document"><link rel="prev" href="step-rollover-zsk.html" title="Current ZSK Rollover (Pre-Publish Scheme)"><link rel="next" href="step-emergency-current-zsk.html" title="Emergency ZSK Rollover (Current ZSK Compromise)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">KSK Rollover (Double-Signature Scheme)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="step-rollover-zsk.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="step-emergency-current-zsk.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="step-rollover-ksk"></a>KSK Rollover (Double-Signature Scheme)</h2></div></div></div><p>This section gives the steps necessary for the double-signature
    scheme for KSK rollover. The alternative, the pre-publish method, is used
    for rolling over ZSKs. Double signatures for records signed by the ZSK can
    increase the size of the zone many times. The pre-publish scheme, although
    requiring more steps for the rollover, does not suffer from this problem.
    The size argument does not apply during KSK rollover since the DNSKEY
    RRset is the only record doubly signed by the KSK.</p><p>The DNSSEC-Tools utilities do not currently handle KSK rollover. The
    steps given below detail the double-signature scheme used for KSK
    rollover.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="step-rollover-ksk-manual"></a>Manual KSK Rollover</h3></div></div></div><p>The steps for performing a manual KSK rollover are given
        below.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-1"></a>Ensure that Sufficient Time has Elapsed Since the Last
            Rollover</h4></div></div></div><p>The time between rollovers has to be at least twice the
            maximum zone TTL period. This is the largest TTL in the entire
            zone file multiplied by two.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-2"></a>Generate a New KSK</h4></div></div></div></div><p>Generate a new KSK as described in Section ???.</p><div class="table"><a name="id927973"></a><p class="title"><b>Table 10. </b></p><div class="table-contents"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col></colgroup><tbody><tr><td rowspan="2" align="center">
                            <span class="bold"><strong>Zone</strong></span>
                        </td><td colspan="4" align="center">
                            <span class="bold"><strong>ZSKs</strong></span>
                        </td><td colspan="4" align="center">
                            <span class="bold"><strong>KSKs</strong></span>
                        </td><td rowspan="2" align="center">
                            <span class="bold"><strong>Exp</strong></span>
                        </td></tr><tr><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td></tr><tr><td rowspan="2" align="center">
                            <span class="emphasis"><em>zone-name</em></span>
                        </td><td align="center">
                            <span class="underline">zsktag-cur</span>
                        </td><td align="center">1024</td><td align="center">
                            <span class="underline">date</span>
                        </td><td align="center">C</td><td align="center">
                            <span class="underline">ksktag</span>

                            <span class="underline"></span>
                        </td><td align="center">2048</td><td align="center">
                            <span class="underline">date</span>

                            <span class="underline"></span>
                        </td><td align="center">C</td><td rowspan="2" align="center">
                            <span class="underline">date</span>

                            <span class="underline"></span>

                            <span class="underline"></span>
                        </td></tr><tr><td align="center">
                            <span class="underline">zsktag-pub</span>
                        </td><td align="center">1024</td><td align="center">
                            <span class="underline">date</span>
                        </td><td align="center">P</td><td align="center">
                            <span class="underline">ksktag</span>
                        </td><td align="center">2048</td><td align="center">
                            <span class="underline">date</span>
                        </td><td align="center">P</td></tr></tbody></table></div></div><br class="table-break"><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-3"></a>Modify the Zone File</h4></div></div></div><p>The zone file must be modified to account for the new KSK.
            Also, the SOA serial number must be incremented so that the zone
            file's new contents will be recognized.</p><p>The required key changes are made by adding a new <span class="bold"><strong>$INCLUDE</strong></span> lines for the new KSK.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-4"></a>Re-Sign the Zone DNSKEY RRset with the Current and
            Published KSKs</h4></div></div></div><p>ZSKs sign the zone data, whereas KSKs sign the RRset for all
            DNSKEYs recognized by the zone. There is no direct way to create
            the signed DNSKEY RRset for the zone; it is only formed as a
            by-product of the <span class="bold"><strong>dnssec-signzone</strong></span>
            operation.</p><p>Follow steps ??? -- ??? if the zone does no delegation.
            Follow steps ??? -- ??? if the zone does delegation. The ZSK used
            in the signing process in Section ??? or ??? must be the key that
            is marked as the Current key (C) in the Key-Tag table. Both the
            Current KSK and the Published KSK must be simultaneously included
            in the <span class="bold"><strong>dnssec-signzone</strong></span> operation
            (by using two <span class="emphasis"><em>-k</em></span> options).</p><p>Update the Key-Tags table to record the signature expiration
            date.</p><div class="table"><a name="id928325"></a><p class="title"><b>Table 11. </b></p><div class="table-contents"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col></colgroup><tbody><tr><td rowspan="2" align="center">
                                <span class="bold"><strong>Zone</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>ZSKs</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>KSKs</strong></span>
                            </td><td rowspan="2" align="center">
                                <span class="bold"><strong>Exp</strong></span>
                            </td></tr><tr><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td></tr><tr><td rowspan="2" align="center">
                                <span class="emphasis"><em>zone-name</em></span>
                            </td><td align="center">
                                <span class="underline">zsktag-cur</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">C</td><td align="center">
                                <span class="underline">ksktag</span>

                                <span class="underline"></span>
                            </td><td align="center">2048</td><td align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>
                            </td><td align="center">C</td><td align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>
                            </td></tr><tr><td align="center">
                                <span class="underline">zsktag-pub</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">P</td><td align="center">
                                <span class="underline">ksktag</span>
                            </td><td align="center">2048</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">P</td><td align="center">
                                <span class="underline">date</span>
                            </td></tr></tbody></table></div></div><br class="table-break"></div><p>Although the keyset has changed, it <span class="bold"><strong>must
        not</strong></span> be sent to the parent yet.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-5"></a>Reload the Zone</h4></div></div></div><p>The <span><strong class="command">rndc</strong></span> will reload the name server
            configuration files and the zone contents. The name server process
            is assumed to be already running.</p><table class="simplelist" border="0" summary="Simple list"><tr><td>
                    <span><strong class="command"># rndc reload zone-name</strong></span>
	            <strong class="userinput"><code>[ENTER]</code></strong>
                </td></tr><tr><td>
                    <span><strong class="command">#</strong></span>
                </td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-6"></a>Wait for Old DNSKEY RRset to Expire from Caches</h4></div></div></div><p>Wait at least twice the maximum zone TTL period for the old
            DNSKEY RRset to expire from name server caches. This is the
            largest TTL in the entire zone file multiplied by two. This will
            also allow the new data to propagate.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-7"></a>Modify the Zone File</h4></div></div></div><p>The zone file must be modified to delete the Current KSK.
            The SOA serial number must be incremented so that the zone file's
            new contents will be recognized.</p><p>The required key changes are made by deleting the <span class="bold"><strong>$INCLUDE</strong></span> line for the Current KSK. The
            Published KSK, by default, becomes the Current KSK.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-8"></a>Re-Sign the Zone DNSKEY RRset with the New Current
            KSK</h4></div></div></div><p>The RRset for all DNSKEYs is signed by the Current (only
            remaining) KSK. There is no direct way to create the signed DNSKEY
            RRset for the zone; it is only formed as a by-product of the
            <span class="bold"><strong>dnssec-signzone</strong></span> operation.</p><p>Follow steps ??? -- ??? if the zone does no delegation.
            Follow steps ??? -- ??? if the zone does delegation.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-8"></a>Update the Key-Tags Table with the Latest KSK</h4></div></div></div><p>Delete the Current KSK and change the status of the new KSK
            from Published (P) to Current (C). Record the signature expiry
            date in the Key-Tags table.</p><div class="table"><a name="id928760"></a><p class="title"><b>Table 12. </b></p><div class="table-contents"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col></colgroup><tbody><tr><td rowspan="2" align="center">
                                <span class="bold"><strong>Zone</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>ZSKs</strong></span>
                            </td><td colspan="4" align="center">
                                <span class="bold"><strong>KSKs</strong></span>
                            </td><td rowspan="2" align="center">
                                <span class="bold"><strong>Exp</strong></span>
                            </td></tr><tr><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td><td align="center">Tag</td><td align="center">Size</td><td align="center">Creat</td><td align="center">S</td></tr><tr><td rowspan="3" align="center">
                                <span class="emphasis"><em>zone-name</em></span>
                            </td><td align="center">
                                <span class="underline">zsktag-cur</span>
                            </td><td align="center">1024</td><td align="center">
                                <span class="underline">date</span>
                            </td><td align="center">C</td><td align="center">
                                <span class="underline">ksktag</span>

                                <span class="underline"></span>
                            </td><td align="center">2048</td><td align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>
                            </td><td align="center">C</td><td align="center">
                                <span class="underline">date</span>

                                <span class="underline"></span>
                            </td></tr><tr><td rowspan="2" align="center">
                                <span class="underline">zsktag-pub</span>
                            </td><td rowspan="2" align="center">1024</td><td rowspan="2" align="center">
                                <span class="underline">date</span>
                            </td><td rowspan="2" align="center">P</td><td rowspan="2" align="center">
                                <span class="underline">ksktag</span>
                            </td><td rowspan="2" align="center">2048</td><td rowspan="2" align="center">
                                <span class="underline">date</span>
                            </td><td rowspan="2" align="center"><p>P</p><p></p><p>C</p></td><td align="center">
                                <span class="underline">date</span>
                            </td></tr><tr><td align="center"> </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-9"></a>Perform Steps in Section ??? if this Zone is a Secure
            Delegation from Another Zone</h4></div></div></div><p>The keyset generated in Section ??? contains only the new
            KSK. This keyset must be sent to the parent in order to complete
            the secure delegation.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-10"></a>Reload the Zone</h4></div></div></div><p>The <span><strong class="command">rndc</strong></span> will reload the name server
            configuration files and the zone contents. The name server process
            is assumed to be already running.</p><table class="simplelist" border="0" summary="Simple list"><tr><td>
                    <span><strong class="command"># rndc reload zone-name</strong></span>
                </td></tr><tr><td>
                    <span><strong class="command">#</strong></span>
                </td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="step-rollover-ksk-manual-11"></a>Dispose of the Old KSK</h4></div></div></div><p>Delete the old ZSK's <span class="emphasis"><em>.private</em></span> and
            <span class="emphasis"><em>.key</em></span> files.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="step-rollover-zsk.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="step-emergency-current-zsk.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Current ZSK Rollover (Pre-Publish Scheme) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Emergency ZSK Rollover (Current ZSK Compromise)</td></tr></table></div></body></html>
