<?xml version="1.0" encoding="UTF-8"?>
<chapter id="step-toolset-configure">
  <title>Configuring the Toolset</title>

  <para>The following sections must be read before proceeding with the rest of
  this guide.</para>

  <para>The steps in <xref linkend="configure-check-randomness" /> and <xref
  linkend="configure-edit-configuration-file" /> <emphasis>MUST</emphasis> be
  performed prior to following any other steps.</para>

  <section id="configure-check-randomness">
    <title>Check for Randomness</title>

    <para>Key generation and zone signing require random data to create strong
    cryptographic material. The <command>zonesigner</command> command defaults
    to using random data from <filename>/dev/random</filename>. Use this test
    to verify that <filename>/dev/random</filename> will provide data when
    requested:</para>

    <para><prompt>$</prompt> <command>dd <option>if=/dev/random</option>
    <option>bs=2</option> <option>count=10</option></command> | <command>od
    <option>-x</option></command> <userinput>[ENTER]</userinput></para>

    <para>The above command checks if /dev/random is able to provide random
    data when queried; it does not check to see that the data provided is
    truly random.</para>

    <para>If this command provides data immediately, the
    <filename>/dev/random</filename> will provide the data you need. If it
    hangs, then <command>zonesigner</command> won't be able to retrieve random
    data from <filename>/dev/random</filename>.</para>

    <para>If this check for randomness fails, pseudorandom numbers can be used
    instead. However, using pseudorandom numbers significantly affects the
    quality of the crypto material. A more appropriate measure would be to run
    <command>zonesigner</command> on a different system that has
    <filename>/dev/random</filename> and the ability to generate good random
    data.</para>
  </section>

  <section id="configure-edit-configuration-file">
    <title>Edit the Configuration File</title>

    <para>The default location for the DNSSEC-Tools configuration file is
    <filename>/usr/local/etc/dnssec/dnssec-tools.conf</filename>.</para>

    <para>The set of options that you may consider modifying are outlined
    below. For each option, a recommended setting is provided.</para>

    <table colsep="0" frame="none" rowsep="0">
      <title>DNSSEC-Tools Configuration Options</title>

      <tgroup cols="3">
        <thead>
          <row>
            <entry>Option</entry>

            <entry>Description</entry>

            <entry>Recommended Setting</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry>kskdirectory</entry>

            <entry>Directory where the KSK keys are stored.</entry>

            <entry><filename>keys</filename></entry>
          </row>

          <row>
            <entry>zskdirectory</entry>

            <entry>Directory where the ZSK keys are stored.</entry>

            <entry><filename>keys</filename></entry>
          </row>

          <row>
            <entry>ksdir</entry>

            <entry>Directory where the <filename>keyset-</filename> and
            <filename>dsset-</filename> files for both the current zone and
            any children are stored.</entry>

            <entry><filename>sets</filename></entry>
          </row>

          <row>
            <entry>algorithm</entry>

            <entry>The cryptographic algorithm to use for the keys.</entry>

            <entry>rsasha1</entry>
          </row>

          <row>
            <entry>ksklength</entry>

            <entry>The length of the KSK key.</entry>

            <entry>2048</entry>
          </row>

          <row>
            <entry>zsklength</entry>

            <entry>The length of the ZSK key.</entry>

            <entry>1024</entry>
          </row>

          <row>
            <entry>random</entry>

            <entry>This specifies the random device to use.</entry>

            <entry>If the random device was determined to work fine in <xref
            linkend="configure-check-randomness" />, then this should be set
            to <filename>/dev/random</filename>. If there was a problem with
            the device, then this can be set to
            <filename>/dev/urandom</filename>, but it should be understood
            that pseudorandom numbers significantly affect the quality of the
            crypto material.</entry>
          </row>

          <row>
            <entry>endtime</entry>

            <entry>The lifetime of the signatures.</entry>

            <entry>+2592000 (30 days)</entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </section>
</chapter>