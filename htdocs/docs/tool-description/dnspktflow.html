<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>dnspktflow - Analyze and draw DNS flow diagrams from a tcpdump file</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#requirements">REQUIREMENTS</a></li>
	<li><a href="#options">OPTIONS</a></li>
	<ul>

		<li><a href="#input_packet_selection">Input Packet Selection</a></li>
		<li><a href="#output_file_options">Output File Options</a></li>
		<li><a href="#output_visualization_options_">Output Visualization Options:</a></li>
		<li><a href="#graphical_options_">Graphical Options:</a></li>
		<li><a href="#debugging_">Debugging:</a></li>
	</ul>

	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>dnspktflow - Analyze and draw DNS flow diagrams from a tcpdump file</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
  dnspktflow -o output.png file.tcpdump</pre>
<pre>
  dnspktflow -o output.png -x -a -t -q file.tcpdump</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>The <strong>dnspktflow</strong> application takes a <strong>tcpdump</strong> network traffic dump
file, passes it through the <strong>tshark</strong> application and then displays the
resulting DNS packet flows in a &quot;flow-diagram&quot; image.  <strong>dnspktflow</strong>
can output a single image or a series of images which can then be
shown in sequence as an animation.</p>
<p><strong>dnspktflow</strong> was written as a debugging utility to help trace DNS
queries and responses, especially as they apply to DNSSEC-enabled lookups.</p>
<p>
</p>
<hr />
<h1><a name="requirements">REQUIREMENTS</a></h1>
<p>This application requires the following Perl modules and software
components to work:</p>
<pre>
  graphviz                  (<a href="http://www.graphviz.org/">http://www.graphviz.org/</a>)
  GraphViz                  (Perl module)
  tshark                    (<a href="http://www.wireshark.org/">http://www.wireshark.org/</a>)</pre>
<p>The following is required for outputting screen presentations:</p>
<pre>
  MagicPoint                (<a href="http://member.wide.ad.jp/wg/mgp/">http://member.wide.ad.jp/wg/mgp/</a>)</pre>
<p>If the following modules are installed, a GUI interface will be enabled for
communication with <strong>dnspktflow</strong>:</p>
<pre>
  QWizard                   (Perl module)
  Getopt::GUI::Long         (Perl module)</pre>
<p>
</p>
<hr />
<h1><a name="options">OPTIONS</a></h1>
<p><strong>dnspktflow</strong> takes a wide variety of command-line options.  These options
are described below in the following functional groups:  input packet
selection, output file options, output visualization options, graphical
options, and debugging.</p>
<p>
</p>
<h2><a name="input_packet_selection">Input Packet Selection</a></h2>
<p>These options determine the packets that will be selected by <strong>dnspktflow</strong>.</p>
<dl>
<dt><strong><a name="i_string" class="item">-i STRING</a></strong></dt>

<dt><strong><a name="ignore_hosts_string" class="item">--ignore-hosts=STRING</a></strong></dt>

<dd>
<p>A regular expression of host names to ignore in the query/response fields.</p>
</dd>
<dt><strong><a name="r_string" class="item">-r STRING</a></strong></dt>

<dt><strong><a name="only_hosts_string" class="item">--only-hosts=STRING</a></strong></dt>

<dd>
<p>A regular expression of host names to analyze in the query/response fields.</p>
</dd>
<dt><strong><a name="f" class="item">-f</a></strong></dt>

<dt><strong><a name="show_frame_num" class="item">--show-frame-num</a></strong></dt>

<dd>
<p>Display the packet frame numbers.</p>
</dd>
<dt><strong><a name="b_integer" class="item">-b INTEGER</a></strong></dt>

<dt><strong><a name="begin_frame_integer" class="item">--begin-frame=INTEGER</a></strong></dt>

<dd>
<p>Begin at packet frame NUMBER.</p>
</dd>
</dl>
<p>
</p>
<h2><a name="output_file_options">Output File Options</a></h2>
<p>These options determine the type and location of <strong>dnspktflow</strong>'s output.</p>
<dl>
<dt><strong><a name="o_string" class="item">-o STRING</a></strong></dt>

<dt><strong><a name="output_file_string" class="item">--output-file=STRING</a></strong></dt>

<dd>
<p>Output file name (default: out%03d.png as PNG format.)</p>
</dd>
<dt><strong><a name="fig" class="item">--fig</a></strong></dt>

<dd>
<p>Output format should be fig.</p>
</dd>
<dt><strong><a name="o_string" class="item">-O STRING</a></strong></dt>

<dt><strong><a name="tshark_out_string" class="item">--tshark-out=STRING</a></strong></dt>

<dd>
<p>Save <strong>tshark</strong> output to this file.</p>
</dd>
<dt><strong><a name="m" class="item">-m</a></strong></dt>

<dt><strong><a name="multiple_outputs" class="item">--multiple-outputs</a></strong></dt>

<dd>
<p>One picture per request (use %03d in the filename.)</p>
</dd>
<dt><strong><a name="m_string" class="item">-M STRING</a></strong></dt>

<dt><strong><a name="magic_point_string" class="item">--magic-point=STRING</a></strong></dt>

<dd>
<p>Saves a MagicPoint presentation for the output.</p>
</dd>
</dl>
<p>
</p>
<h2><a name="output_visualization_options_">Output Visualization Options:</a></h2>
<p>These options determine specifics of <strong>dnspktflow</strong>'s output.</p>
<dl>
<dt><strong><a name="layout_style" class="item">--layout-style</a></strong></dt>

<dd>
<p>Selects the graphviz layout style to use (dot, neato, twopi, circo, or fdp).</p>
</dd>
<dt><strong><a name="l" class="item">-L</a></strong></dt>

<dt><strong><a name="last_line_labels_only" class="item">--last-line-labels-only</a></strong></dt>

<dd>
<p>Only show data on the last line drawn.</p>
</dd>
<dt><strong><a name="z_integer" class="item">-z INTEGER</a></strong></dt>

<dt><strong><a name="most_lines_integer" class="item">--most-lines=INTEGER</a></strong></dt>

<dd>
<p>Only show at most INTEGER connections.</p>
</dd>
<dt><strong><a name="t" class="item">-T</a></strong></dt>

<dt><strong><a name="input_is_tshark_out" class="item">--input-is-tshark-out</a></strong></dt>

<dd>
<p>The input file is already processed by <strong>tshark</strong>.</p>
</dd>
</dl>
<p>
</p>
<h2><a name="graphical_options_">Graphical Options:</a></h2>
<p>These options determine fields included in <strong>dnspktflow</strong>'s output.</p>
<dl>
<dt><strong><a name="t" class="item">-t</a></strong></dt>

<dt><strong><a name="show_type" class="item">--show-type</a></strong></dt>

<dd>
<p>Shows message type in result image.</p>
</dd>
<dt><strong><a name="q" class="item">-q</a></strong></dt>

<dt><strong><a name="show_queries" class="item">--show-queries</a></strong></dt>

<dd>
<p>Shows query questions in result image.</p>
</dd>
<dt><strong><a name="a" class="item">-a</a></strong></dt>

<dt><strong><a name="show_answers" class="item">--show-answers</a></strong></dt>

<dd>
<p>Shows query answers in result image.</p>
</dd>
<dt><strong><a name="a" class="item">-A</a></strong></dt>

<dt><strong><a name="show_authoritative" class="item">--show-authoritative</a></strong></dt>

<dd>
<p>Shows authoritative information in result image.</p>
</dd>
<dt><strong><a name="x" class="item">-x</a></strong></dt>

<dt><strong><a name="show_additional" class="item">--show-additional</a></strong></dt>

<dd>
<p>Shows additional information in result image.</p>
</dd>
<dt><strong><a name="l" class="item">-l</a></strong></dt>

<dt><strong><a name="show_label_lines" class="item">--show-label-lines</a></strong></dt>

<dd>
<p>Shows lines attaching labels to lines.</p>
</dd>
<dt><strong><a name="fontsize_integer" class="item">--fontsize=INTEGER</a></strong></dt>

<dd>
<p>Font Size</p>
</dd>
</dl>
<p>
</p>
<h2><a name="debugging_">Debugging:</a></h2>
<p>These options may assist in debugging <strong>dnspktflow</strong>.</p>
<dl>
<dt><strong><a name="d" class="item">-d</a></strong></dt>

<dt><strong><a name="dump_pkts" class="item">--dump-pkts</a></strong></dt>

<dd>
<p>Dump data collected from the packets.</p>
</dd>
<dt><strong><a name="h" class="item">-h</a></strong></dt>

<dt><strong><a name="help" class="item">--help</a></strong></dt>

<dd>
<p>Show help for command line options.</p>
</dd>
</dl>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2004-2009 SPARTA, Inc.  All rights reserved.
See the COPYING file included with the DNSSEC-Tools package for details.</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Wes Hardaker &lt;<a href="mailto:hardaker@users.sourceforge.net">hardaker@users.sourceforge.net</a>&gt;</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><strong>Getopt::GUI::Long(3)</strong>
<strong>Net::DNS(3)</strong>
<strong>QWizard.pm(3)</strong></p>
<p><a href="http://dnssec-tools.sourceforge.net/">http://dnssec-tools.sourceforge.net/</a></p>

</body>

</html>
