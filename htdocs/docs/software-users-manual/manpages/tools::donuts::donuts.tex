\clearpage

\subsubsection{\bf donuts}


{\bf NAME}

\cmd{donuts} - analyze DNS zone files for errors and warnings

{\bf SYNOPSIS}

\begin{verbatim}
    donuts -h -H -v -l LEVEL -r RULEFILES -i IGNORELIST -C -c configfile
        	 ZONEFILE DOMAINNAME...}
\end{verbatim}

{\bf DESCRIPTION}

DoNutS is a DNS Lint application that examines DNS zone files looking for
particular problems.  This is especially important for zones making use of
DNSSEC security records, since many subtle problems can occur.

If the \perlmod{Text::Wrap} Perl module is installed, \cmd{donuts} will give
better output formatting.

{\bf OPTIONS}

\begin{description}

\item {\it -h}\verb" "

Displays a help message.

\item {\it -v}\verb" "

Turns on more verbose output.

\item {\it -q}\verb" "

Turns on more quiet output.

\item {\it -l LEVEL}\verb" "

Sets the level of errors to be displayed.  The default is level 5.
The maximum value is level 9, which displays many debugging results.
You probably want to run no higher than level 8.

\item {\it -r RULEFILES}\verb" "

A comma-separated list of rule files to load.  The strings will be
passed to \func{glob()} so * wildcards can be used to specify multiple files.

\item {\it -i IGNORELIST}\verb" "

A comma-separated list of regex patterns which are checked against
rule names to determine if some should be ignored.  Run with {\it -v}
to figure out rule names if you're not sure which rule is generating
errors you don't wish to see.

\item {\it -L}\verb" "

Include rules that require live queries of data.  Generally, these
rules concentrate on pulling remote DNS data to test;
for example, parent/child zone relationships.

\item {\it -c CONFIGFILE}\verb" "

Parse a configuration file to change constraints specified by rules.
This defaults to \path{\$HOME/.donuts.conf}.

\item {\it -C}\verb" "

Don't read user configuration files at all, such as those specified by
the {\it -c} option or the \path{\$HOME/.donuts.conf} file.

\item {\it -t INTERFACE}\verb" "

Specifies that \cmd{tcpdump} should be started on {\it INTERFACE} (e.g.,
``eth0'') just before \cmd{donuts} begins its run of rules for each domain
and will stop it just after it has processed the rules.  This is
useful when you wish to capture the traffic generated by the {\it live}
feature, described above.

\item {\it -T FILTER}\verb" "

When \cmd{tcpdump} is run, this {\it FILTER} is passed to it for purposes of
filtering traffic.  By default, this is set to {\it port 53 || ip$[$6:2$]$ \&
0x1fff != 0}, which limits the traffic to traffic destined to port 53
(DNS) or fragmented packets.

\item {\it -o FILE}\verb" "

Saves the \cmd{tcpdump} captured packets to {\it FILE}.  The following
special fields can be used to help generate unique file names:

\begin{description}

\item {\it \%d}\verb" "

This is replaced with the current domain name being analyzed (e.g.,
``example.com''.)

\item {\it \%t}\verb" "

This is replaced with the current epoch time (i.e., the number of
seconds since Jan 1, 1970).

\end{description}

This field defaults to {\it \%d.\%t.pcap}.

\item {\it -H}\verb" "

Displays the personal configuration file rules and tokens that are acceptable
in a configuration file.  The output will consist of a rule name, a token, and
a description of its meaning.

Your configuration file (e.g., \path{\$HOME/.donuts.conf}) may have lines in
it that look like this:

\begin{verbatim}
    # change the default minimum number of legal NS records from 2 to 1
    name: DNS_MULTIPLE_NS
    minnsrecords: 1

    # change the level of the following rule from 8 to 5
    name: DNS_REASONABLE_TTLS
    level: 5
\end{verbatim}

This allows you to override certain aspects of how rules are executed.

\item {\it -R}\verb" "

Displays a list of all known rules along with their description (if available).

\item {\it -F LIST}\verb" "

\item {\it --features=LIST}\verb" "

The {\it --features} option specifies additional rule features that should
be executed.  Some rules are turned off by default because they are
more intensive or require a live network connection, for instance.
Use the {\it --features} flag to turn them on.  The LIST argument should be
a comma-separated list.  Example usage:

\begin{verbatim}
    --features live,data_check
\end{verbatim}

Features available in the default rule set:

\begin{description}

\item {\it live}\verb" "

The {\it live} feature allows rules that need to perform live DNS queries
to run.  Most of these {\it live} rules query parent and children of the
current zone, when appropriate, to see that the parent/child
relationships have been built properly.  For example, if you have a
DS record which authenticates the key used in a child zone the {\it live}
feature will let a rule run which checks to see if the child is
actually publishing the DNSKEY that corresponds to the test zone's DS
record.

\end{description}

\item {\it --show-gui}\verb" "

alpha code

Displays a browsable GUI screen showing the results of the \cmd{donuts} tests.

The \perlmod{QWizard} and \perlmod{Gtk2} Perl modules must be installed
for this to work.

\item {\it --live}\verb" "

Obsolete command line option.  Please use {\it --features live} instead.

\end{description}

{\bf SEE ALSO}

For writing rules that can be loaded by \cmd{donuts}:
\perlmod{Net::DNS::SEC::Tools::Donuts::Rule}

General DNS and DNSSEC usage: \perlmod{Net::DNS}, \perlmod{Net::DNS::SEC}

\perlmod{Gtk2.pm(3)}, \perlmod{QWizard.pm(3)}
