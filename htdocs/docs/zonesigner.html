<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>zonesigner - Generates encryption keys and signs a DNS zone.</title>
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#keyrec_files">KEYREC FILES</a></li>
	<li><a href="#using_zonesigner">USING ZONESIGNER</a></li>
	<li><a href="#options">OPTIONS</a></li>
	<ul>

		<li><a href="#zonesignerspecific_options"><em>zonesigner</em>-specific Options</a></li>
		<li><a href="#dnsseckeygenspecific_options"><em>dnssec-keygen</em>-specific Options</a></li>
		<li><a href="#dnssecsignzonespecific_options"><em>dnssec-signzone</em>-specific Options</a></li>
	</ul>

	<li><a href="#examples">Examples</a></li>
	<li><a href="#notes">NOTES</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>zonesigner - Generates encryption keys and signs a DNS zone.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
  zonesigner [options] &lt;zone-file&gt; &lt;zone-out&gt;</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This script combines into a single command many actions that are required to
sign a DNS zone.  It generates the required KSK and ZSK keys, adds the key
data to a zone record file, signs the zone file, and runs checks to ensure
that everything worked properly.</p>
<p>Using <em>keyrec</em> files, defined and maintained by <strong>dnssec-tools</strong>,
<em>zonesigner</em> can automatically gather many of the options used to previously
sign and generate a zone and its keys.  This allows the zone to be maintained
using the same key lengths and expiration times, for example, without an
administrator needing to manually track these fields.</p>
<p>
</p>
<hr />
<h1><a name="keyrec_files">KEYREC FILES</a></h1>
<p><em>keyrec</em> files retain information about previous key-generation and
zone-signing operations.  If a <em>keyrec</em> file is not specified (by way of the
<em>-krfile</em> option), then a default <em>keyrec</em> file is used.  If this default
in not specified in the system's <strong>dnssec-tools</strong> configuration file, the
filename will be the zone name appended with <strong>.krf</strong>.  If the <em>-nokrfile</em>
option is given, then no <em>keyrec</em> file will be consulted or saved.</p>
<p><em>keyrec</em> files contain two types of entries:  zone <em>keyrec</em>s and key
<em>keyrec</em>s.  Each <em>keyrec</em> contains a set of ``key/value'' entries, one per
line.  Example 4 below contains the contents of a sample <em>keyrec</em> file.</p>
<p>
</p>
<hr />
<h1><a name="using_zonesigner">USING ZONESIGNER</a></h1>
<p><em>zonesigner</em> is used in this way:</p>
<p>zonesigner [options] &lt;zone-file&gt; &lt;zone-out&gt;</p>
<p><em>zone-file</em> is the name of the zone file from which a signed zone file will
be created.  If the <em>-zone</em> option is not given, then it is also the name
of the zone that will be signed.  Generated keys are given this name as their
base.</p>
<p>The zone file is modified to have <strong>include</strong> commands, which will include the
KSK and ZSK keys.  These lines are placed at the end of the file and should
not be modified by the user.  If the zone file already includes any key files,
those inclusions will be deleted.  These lines are distinguished by starting
with ``$INCLUDE'' and end with ``.key''.  Only the actual include lines are
deleted; any related comment lines are left untouched.</p>
<p><em>zone-out</em> is the name of the output zone file.  This file will be a copy
of the <em>zone-file</em> zone file, with some modifications.  Several $INCLUDE
lines will be added at the end of the file and the SOA serial number will be
incremented.</p>
<p>The <em>zone-out</em> argument may be left out, in which case the input zone file
will be used as the base for all operations.</p>
<p>The signed zone file will be this name, appended with <em>.signed</em>.</p>
<p>
</p>
<hr />
<h1><a name="options">OPTIONS</a></h1>
<p>Three types of options may be given, based on the command for which they are
intended.  These commands are  <em>dnssec-keygen</em>, <em>dnssec-signzone</em>, and
<em>zonesigner</em>.</p>
<p>
</p>
<h2><a name="zonesignerspecific_options"><em>zonesigner</em>-specific Options</a></h2>
<dl>
<dt><strong><a name="item__2dnokrfile">-nokrfile</a></strong><br />
</dt>
<dd>
No <em>keyrec</em> file will be consulted or created.
</dd>
<p></p>
<dt><strong><a name="item__2dkrfile">-krfile</a></strong><br />
</dt>
<dd>
<em>keyrec</em> file to use in processing options.  See the man page for
<em>Net::DNS::SEC::Tools::tooloptions</em> for more details about this file.
</dd>
<p></p>
<dt><strong><a name="item__2dreuseksk">-reuseksk</a></strong><br />
</dt>
<dd>
Re-use the zone's current KSK.
</dd>
<p></p>
<dt><strong><a name="item__2dreusezsk">-reusezsk</a></strong><br />
</dt>
<dd>
Re-use the zone's current ZSK.
</dd>
<p></p>
<dt><strong><a name="item__2dzone">-zone</a></strong><br />
</dt>
<dd>
Name of the zone that will be signed.  This zone name may be given with this
option or as the first non-option command line argument.
</dd>
<p></p>
<dt><strong><a name="item__2dhelp">-help</a></strong><br />
</dt>
<dd>
Display a usage message.
</dd>
<p></p>
<dt><strong><a name="item__2dverbose">-verbose</a></strong><br />
</dt>
<dd>
Verbose output will be given.  As more instances of <em>-verbose</em> are given on
the command line, additional levels of verbosity are achieved.
</dd>
<p></p></dl>
<p>
</p>
<h2><a name="dnsseckeygenspecific_options"><em>dnssec-keygen</em>-specific Options</a></h2>
<dl>
<dt><strong><a name="item__2dalgorithm">-algorithm</a></strong><br />
</dt>
<dd>
Cryptographic algorithm used to generate the zone's keys.
The default value is RSASHA1.
</dd>
<p></p>
<dt><strong><a name="item__2dksklength">-ksklength</a></strong><br />
</dt>
<dd>
Bit length of the zone's KSK key.
The default is 1024.
</dd>
<p></p>
<dt><strong><a name="item__2drandom">-random</a></strong><br />
</dt>
<dd>
Source of randomness used to generate the zone's keys.	(/dev/urandom)
</dd>
<p></p>
<dt><strong><a name="item__2dzsklength">-zsklength</a></strong><br />
</dt>
<dd>
Bit length of the zone's ZSK key.
The default is 512.
</dd>
<p></p>
<dt><strong><a name="item__2dkgopts">-kgopts</a></strong><br />
</dt>
<dd>
Additional options for <em>dnssec-keygen</em> may be specified using this option.
The additional options are passed as a single string value as an argument to
the <em>-kgopts</em> option.
</dd>
<p></p></dl>
<p>
</p>
<h2><a name="dnssecsignzonespecific_options"><em>dnssec-signzone</em>-specific Options</a></h2>
<dl>
<dt><strong><a name="item__2dendtime">-endtime</a></strong><br />
</dt>
<dd>
Time that the zone expires, measured in seconds.  See the man page for
<em>dnssec-signzone</em> for the valid format of this field.
The default value is 259200 seconds (30 days.)
</dd>
<p></p>
<dt><strong><a name="item__2dgends">-gends</a></strong><br />
</dt>
<dd>
Force <em>dnssec-signzone</em> to generate DS records for the zone.  This option is
translated into <em>-g</em> when passed to <em>dnssec-signzone</em>.
</dd>
<p></p>
<dt><strong><a name="item__2dksdir">-ksdir</a></strong><br />
</dt>
<dd>
Specify a directory for storing keysets.  This is passed to <em>dnssec-signzone</em>
as the <em>-d</em> option.
</dd>
<p></p>
<dt><strong><a name="item__2dszopts">-szopts</a></strong><br />
</dt>
<dd>
Additional options for <em>dnssec-signzone</em> may be specified using this option.
The additional options are passed as a single string value as an argument to
the <em>-szopts</em> option.
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="examples">Examples</a></h1>
<p>Example 1.</p>
<p>In the first example, an existing <em>keyrec</em> file is used to assist in signing
the example.com domain.  Zone data are stored in <strong>example.com</strong>, and the
keyrec is in <strong>example.krf</strong>.  The output zone file and final signed zone
file will use <strong>db.example.com</strong> as a base.  Using this execution:</p>
<pre>
    # zonesigner -krfile example.krf example.com db.example.com</pre>
<p>the following files are created:</p>
<pre>
    Kexample.com.+005+45842.private
    Kexample.com.+005+45842.key
    Kexample.com.+005+50186.private
    Kexample.com.+005+50186.key
    Kexample.com.+005+59143.key
    Kexample.com.+005+59143.private</pre>
<pre>
    dsset-example.com.
    keyset-example.com.</pre>
<pre>
    db.example.com
    db.example.com.signed</pre>
<p>The first six files are the KSK and ZSK keys required for the zone.  The next
two files are created by the zone-signing process.  The last two are the zone
file used as input to the zone-signing process and the final signed zone.</p>
<p>Example 2.</p>
<p>In the second example, an existing <em>keyrec</em> file is used to assist in signing
the example.com domain.  Zone data are stored in <strong>example.com</strong>, and the
keyrec is in <strong>example.krf</strong>.  The generated keys, output zone file, and final
signed zone file will use <strong>example.com</strong> as a base.  Using this execution:</p>
<pre>
    # zonesigner -krfile example.krf db.example.com</pre>
<p>the following files are created:</p>
<pre>
    Kdb.example.com.+005+12354.key
    Kdb.example.com.+005+12354.private
    Kdb.example.com.+005+82197.key
    Kdb.example.com.+005+82197.private
    Kdb.example.com.+005+55888.key
    Kdb.example.com.+005+55888.private</pre>
<pre>
    dsset-db.example.com.
    keyset-db.example.com.</pre>
<pre>
    db.example.com.signed</pre>
<p>The first six files are the KSK and ZSK keys required for the zone.  The next
two files are created by the zone-signing process.  The last file is file is
the final signed zone.</p>
<p>Example 3.</p>
<p>In the third example, no <em>keyrec</em> file is specified for the signing of
the example.com domain.  In addition to files created as shown in previous
examples, a new <em>keyrec</em> file is created.  The new <em>keyrec</em> file uses the
domain name as its base.  Using this execution:</p>
<pre>
    # zonesigner example.com db.example.com</pre>
<p>the following <em>keyrec</em> file is created:</p>
<pre>
    example.com.krf</pre>
<p>Example 4.</p>
<p>This example shows a <em>keyrec</em> file generated by <em>zonesigner</em>.</p>
<p>The command executed is:</p>
<pre>
    # zonesigner example.com db.example.com</pre>
<p>The generated <em>keyrec</em> file contains three <em>keyrec</em>s:  a zone <em>keyrec</em>,
one KSK <em>keyrec</em>, and two ZSK <em>keyrec</em>s.</p>
<pre>
    zone        &quot;example.com&quot;
        zskpubpath      &quot;./Kexample.com.+005+13531.key&quot;
        zskpub          &quot;Kexample.com.+005+13531&quot;
        zskdirectory    &quot;.&quot;
        zskcurpath      &quot;./Kexample.com.+005+53135.key&quot;
        zskcur          &quot;Kexample.com.+005+53135&quot;
        signedfile      &quot;db.example.com.signed&quot;
        kskpath         &quot;./Kexample.com.+005+24082.key&quot;
        kskkey          &quot;Kexample.com.+005+24082&quot;
        kskdirectory    &quot;.&quot;
        endtime         &quot;+259200&quot;
        zonefile        &quot;db.example.com&quot;
        keyrec_type     &quot;zone&quot;
        keyrec_signsecs &quot;1115166642&quot;
        keyrec_signdate &quot;Wed May  4 00:30:42 2005&quot;</pre>
<pre>
    key         &quot;Kexample.com.+005+24082&quot;
        zonename        &quot;example.com&quot;
        keyrec_type     &quot;ksk&quot;
        algorithm       &quot;rsasha1&quot;
        random          &quot;/dev/urandom&quot;
        keypath         &quot;./Kexample.com.+005+24082.key&quot;
        ksklength       &quot;1024&quot;
        keyrec_gensecs  &quot;1115166638&quot;
        keyrec_gendate  &quot;Wed May  4 00:30:38 2005&quot;</pre>
<pre>
    key         &quot;Kexample.com.+005+53135&quot;
        zonename        &quot;example.com&quot;
        keyrec_type     &quot;zskcur&quot;
        algorithm       &quot;rsasha1&quot;
        random          &quot;/dev/urandom&quot;
        keypath         &quot;./Kexample.com.+005+53135.key&quot;
        zsklength       &quot;512&quot;
        keyrec_gensecs  &quot;1115166638&quot;
        keyrec_gendate  &quot;Wed May  4 00:30:38 2005&quot;</pre>
<pre>
    key         &quot;Kexample.com.+005+13531&quot;
        zonename        &quot;example.com&quot;
        keyrec_type     &quot;zskpub&quot;
        algorithm       &quot;rsasha1&quot;
        random          &quot;/dev/urandom&quot;
        keypath         &quot;./Kexample.com.+005+13531.key&quot;
        zsklength       &quot;512&quot;
        keyrec_gensecs  &quot;1115166638&quot;
        keyrec_gendate  &quot;Wed May  4 00:30:38 2005&quot;</pre>
<p>
</p>
<hr />
<h1><a name="notes">NOTES</a></h1>
<ol>
<li><strong><a name="item_soa_serial_numbers">SOA Serial Numbers</a></strong><br />
</li>
Serial numbers in SOA records are merely incremented in this version.  Future
plans are to allow for more flexible serial number manipulation.
<p></p></ol>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Wayne Morrison, <a href="mailto:tewok@users.sourceforge.net">tewok@users.sourceforge.net</a></p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>Net::DNS::SEC::Tools::conf.pm(3), Net::DNS::SEC::Tools::keyrec.pm(3), Net::DNS::SEC::Tools::tooloptions.pm(3)</p>

<!--#include virtual="/page-bottom.html" -->
</body>

</html>
